# Планирование: анализ, идентификация проблем и поиск решений

### Проблемные места

1. Потеря заказов. Производство не загружено на максимум, но есть потеря заказов, причина неизвестна

2. Нет Observability. Из-за отсутствия метрик, логов, трейсов нельзя определить причину потери заказов

3. Медленная загрузка главной страницы MES. У операторов затруднена работа из-за долгой загрузки MES

4. Отказоустойчивость. У каждого приложения и БД всего один инстанс

5. Нет rate limit на запросы API. B2B-партнеры могут перегрузить систему

6. Долгий рассчет стоимости может принести проблемы при увеличении числа заказов

7. Возможное отсутствие DLQ в RabbitMQ и потеря заказов из-за этого

### Инициативы

**Первый приоритет (понять причину потери заказов):**
- Настроить DLQ и алертинг в RabbitMQ
- Внедрить трейсинг (Jaeger)
- Внедрить централизованные логи (ELK)

**Второй приоритет (базовый мониторинг и стабилизация):**
- Внедрить мониторинг (Prometheus + Grafana)
- Добавить кеширование дашборда MES (Redis)
- Добавить rate limiting на API

**Третий приоритет (масштабирование):**
- Добавить ретраи и внедрить circuit breaker
- Горизонтальное масштабирование приложений(2+ инстанса)
- Добавить read-реплики БД

### Целевая архитектура

Через 6 месяцев:
- 2+ инстанса каждого приложения за load balancer
- Read-реплики для Shop DB и MES DB
- Redis для кеша дашборда MES
- Observability через Prometheus/Grafana, Jaeger, ELK
- DLQ в RabbitMQ
- Rate limiting на B2B API
- Circuit breaker для API

### Топ-3 инициативы

1. **DLQ в RabbitMQ** — быстро покажет, теряются ли сообщения
2. **Трейсинг** — увидеть путь заказа через все системы
3. **Централизованные логи** — разбор инцидентов за минуты вместо часов

Observability выбран приоритетно потому что позволит понять где происходит потеря заказов, что сейчас максимально затруднено
